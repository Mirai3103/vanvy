<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pan - Chẩn đoán hư hỏng (Alpine.js)</title>
    <link rel="stylesheet" href="./font1.css">
    <script src="./assets/alpine.js" defer></script>
    <link rel="stylesheet" href="./tailwind.output.css" />
    <script src="./assets/splotligt.js"></script>

    <style>
      * {
        box-sizing: border-box;
      }
      body {
        font-family: "Roboto", sans-serif;
        margin: 0;
        background-color: #f8f9fa;
        min-height: 100vh;
      }

      /* Header */
      header {
        display: flex;
        align-items: center;
        background-color: #e3f2fd;
        color: #d32f2f;
        padding: 15px 30px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .logoiuh {
        width: 70px;
        height: auto;
        margin-right: 25px;
        border-radius: 8px;
      }
      header h1 {
        font-size: 1.2em;
        line-height: 1.3;
        font-weight: 600;
        margin: 0;
        color: #d32f2f;
      }

      /* Main Layout */
      .main-container {
        display: flex;
        height: calc(100vh - 80px);
        gap: 0;
      }

      /* Left Sidebar */
      .sidebar {
        width: 320px;
        background: white;
        border-right: 1px solid #e1e5e9;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.05);
        overflow-y: auto;
        display: flex;
        flex-direction: column;
      }

      /* Dropdown */
      .dropdown-container {
        padding: 20px;
        border-bottom: 1px solid #e1e5e9;
      }
      .dropdown-btn {
        background-color: #1976d2;
        color: white;
        padding: 12px 16px;
        font-size: 14px;
        border: none;
        cursor: pointer;
        width: 100%;
        text-align: left;
        border-radius: 8px;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(25, 118, 210, 0.3);
      }
      .dropdown-btn:hover {
        background-color: #1565c0;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(25, 118, 210, 0.4);
      }
      .dropdown-content {
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        margin-top: 8px;
        max-height: 400px;
        overflow-y: auto;
      }
      .dropdown-content a {
        color: #333;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        cursor: pointer;
        border-bottom: 1px solid #f0f0f0;
        font-size: 13px;
        transition: all 0.2s ease;
      }
      .dropdown-content a:last-child {
        border-bottom: none;
      }
      .dropdown-content a:hover {
        background-color: #1976d2;
        color: white;
      }

      /* Right Content Area */
      .content-area {
        flex: 1;
        background: white;
        overflow-y: auto;
        padding: 30px;
      }

      .content-section {
        max-width: 100%;
      }

      .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 60vh;
        color: #666;
        text-align: center;
      }
      .empty-state h3 {
        margin-bottom: 10px;
        color: #333;
      }

      /* Step Buttons */
      .button-container {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 25px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 12px;
        border: 1px solid #e9ecef;
      }
      .custom-button {
        background: white;
        border: 1px solid #dee2e6;
        padding: 8px 16px;
        cursor: pointer;
        border-radius: 20px;
        transition: all 0.3s ease;
        font-size: 13px;
        font-weight: 500;
        color: #495057;
      }
      .custom-button:hover {
        background: #e9ecef;
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      .custom-button.active {
        background-color: #1976d2;
        color: white;
        border-color: transparent;
        box-shadow: 0 2px 12px rgba(25, 118, 210, 0.3);
      }

      /* Content */
      .hidden-content {
        border-top: 3px solid #1976d2;
        padding-top: 20px;
        border-radius: 0 0 12px 12px;
      }
      .hidden-content h2 {
        color: #333;
        font-size: 1.4em;
        margin-bottom: 15px;
        font-weight: 600;
      }
      .hidden-content p {
        line-height: 1.6;
        color: #555;
        margin-bottom: 15px;
      }

      /* Images and Tables */
      img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      .hinhmota,
      .hinhmota1 {
        display: flex;
        gap: 12px;
        margin-bottom: 15px;
        flex-wrap: wrap;
      }
      .hinhmota img,
      .hinhmota1 img {
        width: 120px;
        height: 90px;
        object-fit: cover;
        border: 1px solid #dee2e6;
      }
      .HIGH,
      .KVNN,
      .AC {
        max-width: 500px;
        margin: 15px 0;
      }

      /* Tables */
      .my-table1,
      .my-table2,
      .my-table3,
      .my-table4 {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      .my-table1 td,
      .my-table1 th,
      .my-table2 td,
      .my-table2 th,
      .my-table3 td,
      .my-table3 th,
      .my-table4 td,
      .my-table4 th {
        border: 1px solid #dee2e6;
        padding: 12px;
        text-align: left;
      }
      .my-table1 tr:nth-child(even) {
        background-color: #f8f9fa;
      }
      .my-table1 tr:first-child {
        background-color: #1976d2;
        color: white;
      }

      /* Interactive Elements */
      .DOKIEMM,
      .DOKIEM {
        position: relative;
        margin: 20px 0;
      }
      .DOKIEM1 {
        max-width: 600px;
        border-radius: 8px;
      }
      .image-popup {
        position: fixed;
        top: 50%;
        right: 0%;
        transform: translate(-25%, -50%);
        z-index: 1000;
        border: 3px solid #1976d2;
        border-radius: 8px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      }
      .image-popup img {
        display: none;
        border-radius: 5px;
        max-width: 90vw;
        max-height: 90vh;
      }
      .box {
        cursor: crosshair;
        border: 2px dashed #3190ee;
        background-color: #3190ee;
        border-radius: 5px;
        position: absolute;
        transition: all 0.2s ease;
        color: white;
      }
      .box:hover {
        border-color: #2b7fe4;
        background-color: #2b7fe4;
        border-radius: 5px;
      }

      /* Scrollbar Styling */
      ::-webkit-scrollbar {
        width: 6px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      ::-webkit-scrollbar-thumb {
        background: #c1c1c1;
        border-radius: 3px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #a8a8a8;
      }

      /* Hide element until Alpine is ready */
      [x-cloak] {
        display: none !important;
      }

      /* Back Button */
      .back-button-container {
        padding: 20px;
        border-top: 1px solid #e1e5e9;
        margin-top: auto;
      }
      .back-button-demo {
        display: block;
        background-color: #d32f2f;
        color: white;
        text-decoration: none;
        padding: 12px 16px;
        border-radius: 8px;
        text-align: center;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(211, 47, 47, 0.3);
      }
      .back-button-demo:hover {
        background-color: #b71c1c;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(211, 47, 47, 0.4);
      }

      /* Responsive */
      @media (max-width: 768px) {
        .main-container {
          flex-direction: column;
          height: auto;
        }
        .sidebar {
          width: 100%;
          border-right: none;
          border-bottom: 1px solid #e1e5e9;
        }
        .content-area {
          padding: 20px;
        }
      }
      .my-table1{
      min-width: 60%;
      width: auto;
      }
      .my-table1 td{
        text-align: center;
      }
    </style>
    <!-- CSS -->


    <script>
      function initSpotlight(container) {
        const imgs = container.querySelectorAll("img");
        if (!imgs.length) return;

        imgs.forEach((img) => {
          // nếu ảnh chưa có class "spotlight", thêm vào
          console.log(img);
          if (!img.classList.contains("spotlight")) {
            img.classList.add("spotlight");
          }

          // nếu ảnh chưa có data-src, thêm từ src gốc (Spotlight cần data-src hoặc href)
          if (!img.dataset.src) {
            img.dataset.src = img.src;
          }
        });
      }
    </script>
  </head>
  <body>
    <header>
      <a href="index.html">
        <img class=" h-[60px]! shadow-none! w-auto!" src="image/logo.png" alt="Logo IUH" 
      /></a>
    </header>

    <div class="main-container" x-data="troubleshootingGuide()" x-cloak>
      <!-- Left Sidebar -->
      <div class="sidebar">
        <div class="dropdown-container">
          <button
            class="dropdown-btn"
            @click="isDropdownOpen = !isDropdownOpen"
          >
            <span
              x-text="selectedCase ? selectedCase.title : 'Chọn trường hợp hư hỏng'"
            ></span>
          </button>

          <div
            x-show="isDropdownOpen"
            @click.away="isDropdownOpen = false"
            class="dropdown-content"
          >
            <template x-for="caseItem in cases" :key="caseItem.id">
              <a @click="selectCase(caseItem.id)" x-text="caseItem.title"></a>
            </template>
          </div>
        </div>

        <!-- Step Navigation -->
        <div x-show="selectedCase" class="button-container" x-if="selectedCase">
          <template x-for="(step, index) in selectedCase.steps" :key="index">
            <button
              class="custom-button"
              @click="selectedStep = index + 1"
              :class="{ 'active': selectedStep === index + 1 }"
              x-text="step"
            ></button>
          </template>
        </div>
        
        <!-- Back Button -->
        <div class="back-button-container">
          <a href="index.html" class="back-button-demo">← Quay về </a>
        </div>
      </div>

      <!-- Right Content Area -->
      <div class="content-area">
        <div x-show="!selectedCase" class="empty-state">
          <h3>Chẩn đoán hư hỏng hệ thống điện</h3>
          <p>
            Vui lòng chọn một trường hợp từ menu bên trái để bắt đầu chẩn đoán.
          </p>
        </div>

        <div x-show="selectedCase" class="content-section">
          <div class="hidden-content" x-if="selectedCase">
            <template
              x-for="(content, index) in selectedCase.contents"
              :key="index"
            >
              <div
                x-show="selectedStep === index + 1"
                x-html="content"
                x-effect="
        if (selectedStep === index + 1) {
          $nextTick(() => initSpotlight($el));
        } 
        "
              ></div>
            </template>
          </div>
        </div>
      </div>
    </div>
    <script src="./demo.js"></script>
  </body>
</html>
